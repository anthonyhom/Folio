{"ast":null,"code":"var _jsxFileName = \"/Users/anthonyhom/Documents/atam-web/src/Component/PostForm.js\";\nimport React from \"react\";\nimport \"../App.css\";\nimport \"../css/modal.css\";\nimport \"../css/postform.css\";\nimport PropTypes from \"prop-types\";\nconst urlRegex = new RegExp(/(?:(?:https?:\\/\\/))[-a-zA-Z0-9@:%._\\+~#=]{2,256}\\.[a-z]{2,4}\\b(?:[-a-zA-Z0-9@:%_\\+.~#?&\\/=]*(\\.jpg|\\.png|\\.jpeg))/g);\n\nconst formValid = ({\n  formErrors,\n  ...rest\n}) => {\n  let valid = true;\n  Object.values(formErrors).forEach(val => {\n    val.length > 0 && (valid = false);\n  });\n  Object.values(rest).forEach(val => {\n    val === null && (valid = false);\n  });\n  return valid;\n};\n\nexport default class PostForm extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.onClose = e => {\n      this.props.onClose && this.props.onClose(e);\n    };\n\n    this.createPost = event => {\n      this.state.title = this.state.title.concat(\"~@~\");\n      this.state.caption = this.state.title.concat(this.state.caption); //keep the form from actually submitting\n\n      event.preventDefault();\n\n      if (formValid(this.state)) {\n        //make the api call to the authentication page\n        fetch(\"http://stark.cse.buffalo.edu/cse410/atam/api/postcontroller.php\", {\n          method: \"post\",\n          body: JSON.stringify({\n            action: \"addOrEditPosts\",\n            user_id: sessionStorage.getItem(\"user\"),\n            userid: sessionStorage.getItem(\"user\"),\n            session_token: sessionStorage.getItem(\"token\"),\n            posttext: this.state.caption,\n            postpicurl: this.state.url,\n            posttype: this.state.tag\n          })\n        }).then(res => res.json()).then(result => {\n          this.setState({\n            apiReturnMessage: result.Status // post_id: result.Status.slice(-2)\n\n          }); // this.addTitle();\n          // this.addTag();\n\n          this.props.loadPosts();\n          this.onClose(); // window.location.reload(false);\n        }, error => {\n          alert(\"error!\");\n        });\n      }\n    };\n\n    this.state = {\n      title: \"\",\n      caption: \"\",\n      tag: \"\",\n      apiReturnMessage: \"\",\n      url: \"\",\n      isDisabled: true,\n      formErrors: {\n        title: \"\",\n        caption: \"\",\n        tag: \"\",\n        url: \"\"\n      }\n    };\n  }\n\n  handleChange(e) {\n    e.preventDefault();\n    const {\n      name,\n      value\n    } = e.target;\n    let formErrors = this.state.formErrors;\n\n    switch (name) {\n      case \"title\":\n        formErrors.title = value.length < 2 ? \"Required\" : \"\";\n        break;\n\n      case \"caption\":\n        formErrors.caption = value.length < 2 ? \"Required\" : \"\";\n        break;\n\n      case \"tag\":\n        formErrors.tag = value === \"\" ? \"Required\" : \"\";\n        break;\n\n      case \"url\":\n        formErrors.url = urlRegex.test(value) ? \"\" : \"invalid image URL\";\n        break;\n\n      default:\n        break;\n    }\n\n    this.setState({\n      formErrors,\n      [name]: value\n    });\n    this.setState({\n      formErrors,\n      isDisabled: !formValid(this.state)\n    });\n  }\n\n  render() {\n    if (!this.props.show) {\n      return null;\n    }\n\n    const {\n      formErrors\n    } = this.state;\n    return React.createElement(\"div\", {\n      id: \"myModal\",\n      className: \"modal\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"modal-content\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"modal-header\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      className: \"close\",\n      onClick: this.onClose,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130\n      },\n      __self: this\n    }, \"\\xD7\"), React.createElement(\"h2\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133\n      },\n      __self: this\n    }, \"Upload a new project\")), React.createElement(\"div\", {\n      className: \"modal-body\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      id: \"modalcontent\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136\n      },\n      __self: this\n    }, React.createElement(\"form\", {\n      onSubmit: this.createPost,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"data-input\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"data-label\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139\n      },\n      __self: this\n    }, \"Name of the Project: \"), React.createElement(\"input\", {\n      className: formErrors.title.length > 0 ? \"error\" : null,\n      name: \"title\",\n      placeholder: \"Project Name\",\n      onChange: e => this.handleChange(e),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140\n      },\n      __self: this\n    }), formErrors.title.length > 0 && React.createElement(\"span\", {\n      className: \"error-message\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147\n      },\n      __self: this\n    }, formErrors.title)), React.createElement(\"div\", {\n      className: \"data-input\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"data-label\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152\n      },\n      __self: this\n    }, \"Caption: \"), React.createElement(\"textarea\", {\n      className: formErrors.caption.length > 0 ? \"error\" : null,\n      type: \"text\",\n      name: \"caption\",\n      placeholder: \"What's this project about?\",\n      onChange: e => this.handleChange(e),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153\n      },\n      __self: this\n    }), formErrors.caption.length > 0 && React.createElement(\"span\", {\n      className: \"error-message\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161\n      },\n      __self: this\n    }, formErrors.caption)), React.createElement(\"div\", {\n      className: \"data-input\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"data-label\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166\n      },\n      __self: this\n    }, \"Collaborators: \"), React.createElement(\"input\", {\n      name: \"collab\",\n      placeholder: \"Collaborators (Optional)\",\n      onChange: e => this.handleChange(e),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"data-input\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"data-label\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175\n      },\n      __self: this\n    }, \"Tags: \"), React.createElement(\"select\", {\n      className: formErrors.tag.length > 0 ? \"error\" : null,\n      name: \"tag\",\n      onChange: e => this.handleChange(e),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176\n      },\n      __self: this\n    }, React.createElement(\"option\", {\n      value: \"\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181\n      },\n      __self: this\n    }, \"Select...\"), React.createElement(\"option\", {\n      value: \"Art\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182\n      },\n      __self: this\n    }, \"Art\"), React.createElement(\"option\", {\n      value: \"Code\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183\n      },\n      __self: this\n    }, \"Code\"), React.createElement(\"option\", {\n      value: \"Music\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184\n      },\n      __self: this\n    }, \"Music\"), React.createElement(\"option\", {\n      value: \"Film\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185\n      },\n      __self: this\n    }, \"Film\"), React.createElement(\"option\", {\n      value: \"Writing\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186\n      },\n      __self: this\n    }, \"Writing\")), formErrors.tag.length > 0 && React.createElement(\"span\", {\n      className: \"error-message\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189\n      },\n      __self: this\n    }, formErrors.tag)), React.createElement(\"div\", {\n      className: \"data-input\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"data-label\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194\n      },\n      __self: this\n    }, \"URL To Picture: \"), React.createElement(\"input\", {\n      className: formErrors.url.length > 0 ? \"error\" : null,\n      name: \"url\",\n      placeholder: \"URL\",\n      onChange: e => this.handleChange(e),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 195\n      },\n      __self: this\n    }), formErrors.url.length > 0 && React.createElement(\"span\", {\n      className: \"error-message\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 202\n      },\n      __self: this\n    }, formErrors.url))))), React.createElement(\"div\", {\n      className: \"modal-footer\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      type: \"submit\",\n      disabled: this.state.isDisabled,\n      className: \"button post-button\",\n      onClick: this.createPost,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 216\n      },\n      __self: this\n    }, \"Post\")))));\n  }\n\n}\nPostForm.propTypes = {\n  onClose: PropTypes.func.isRequired,\n  show: PropTypes.bool.isRequired\n};","map":{"version":3,"sources":["/Users/anthonyhom/Documents/atam-web/src/Component/PostForm.js"],"names":["React","PropTypes","urlRegex","RegExp","formValid","formErrors","rest","valid","Object","values","forEach","val","length","PostForm","Component","constructor","props","onClose","e","createPost","event","state","title","concat","caption","preventDefault","fetch","method","body","JSON","stringify","action","user_id","sessionStorage","getItem","userid","session_token","posttext","postpicurl","url","posttype","tag","then","res","json","result","setState","apiReturnMessage","Status","loadPosts","error","alert","isDisabled","handleChange","name","value","target","test","render","show","propTypes","func","isRequired","bool"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport \"../App.css\";\nimport \"../css/modal.css\";\nimport \"../css/postform.css\";\nimport PropTypes from \"prop-types\";\n\nconst urlRegex = new RegExp(\n  /(?:(?:https?:\\/\\/))[-a-zA-Z0-9@:%._\\+~#=]{2,256}\\.[a-z]{2,4}\\b(?:[-a-zA-Z0-9@:%_\\+.~#?&\\/=]*(\\.jpg|\\.png|\\.jpeg))/g\n);\n\nconst formValid = ({ formErrors, ...rest }) => {\n  let valid = true;\n\n  Object.values(formErrors).forEach((val) => {\n    val.length > 0 && (valid = false);\n  });\n\n  Object.values(rest).forEach((val) => {\n    val === null && (valid = false);\n  });\n\n  return valid;\n};\n\nexport default class PostForm extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      title: \"\",\n      caption: \"\",\n      tag: \"\",\n      apiReturnMessage: \"\",\n      url: \"\",\n      isDisabled: true,\n\n      formErrors: {\n        title: \"\",\n        caption: \"\",\n        tag: \"\",\n        url: \"\",\n      },\n    };\n  }\n\n  onClose = (e) => {\n    this.props.onClose && this.props.onClose(e);\n  };\n\n  createPost = (event) => {\n    this.state.title = this.state.title.concat(\"~@~\");\n    this.state.caption = this.state.title.concat(this.state.caption);\n\n    //keep the form from actually submitting\n    event.preventDefault();\n\n    if (formValid(this.state)) {\n      //make the api call to the authentication page\n      fetch(\"http://stark.cse.buffalo.edu/cse410/atam/api/postcontroller.php\", {\n        method: \"post\",\n        body: JSON.stringify({\n          action: \"addOrEditPosts\",\n          user_id: sessionStorage.getItem(\"user\"),\n          userid: sessionStorage.getItem(\"user\"),\n          session_token: sessionStorage.getItem(\"token\"),\n          posttext: this.state.caption,\n          postpicurl: this.state.url,\n          posttype: this.state.tag,\n        }),\n      })\n        .then((res) => res.json())\n        .then(\n          (result) => {\n            this.setState({\n              apiReturnMessage: result.Status,\n              // post_id: result.Status.slice(-2)\n            });\n\n            // this.addTitle();\n            // this.addTag();\n\n            this.props.loadPosts();\n            this.onClose();\n            // window.location.reload(false);\n          },\n          (error) => {\n            alert(\"error!\");\n          }\n        );\n    }\n  };\n\n  handleChange(e) {\n    e.preventDefault();\n    const { name, value } = e.target;\n    let formErrors = this.state.formErrors;\n\n    switch (name) {\n      case \"title\":\n        formErrors.title = value.length < 2 ? \"Required\" : \"\";\n        break;\n      case \"caption\":\n        formErrors.caption = value.length < 2 ? \"Required\" : \"\";\n        break;\n      case \"tag\":\n        formErrors.tag = value === \"\" ? \"Required\" : \"\";\n        break;\n      case \"url\":\n        formErrors.url = urlRegex.test(value) ? \"\" : \"invalid image URL\";\n        break;\n      default:\n        break;\n    }\n\n    this.setState({ formErrors, [name]: value });\n\n    this.setState({ formErrors, isDisabled: !formValid(this.state) });\n  }\n\n  render() {\n    if (!this.props.show) {\n      return null;\n    }\n\n    const { formErrors } = this.state;\n\n    return (\n      <div id=\"myModal\" className=\"modal\">\n        <div className=\"modal-content\">\n          <div className=\"modal-header\">\n            <span className=\"close\" onClick={this.onClose}>\n              &times;\n            </span>\n            <h2>Upload a new project</h2>\n          </div>\n          <div className=\"modal-body\">\n            <div id=\"modalcontent\">\n              <form onSubmit={this.createPost}>\n                <div className=\"data-input\">\n                  <div className=\"data-label\">Name of the Project: </div>\n                  <input\n                    className={formErrors.title.length > 0 ? \"error\" : null}\n                    name=\"title\"\n                    placeholder=\"Project Name\"\n                    onChange={(e) => this.handleChange(e)}\n                  ></input>\n                  {formErrors.title.length > 0 && (\n                    <span className=\"error-message\">{formErrors.title}</span>\n                  )}\n                </div>\n\n                <div className=\"data-input\">\n                  <div className=\"data-label\">Caption: </div>\n                  <textarea\n                    className={formErrors.caption.length > 0 ? \"error\" : null}\n                    type=\"text\"\n                    name=\"caption\"\n                    placeholder=\"What's this project about?\"\n                    onChange={(e) => this.handleChange(e)}\n                  />\n                  {formErrors.caption.length > 0 && (\n                    <span className=\"error-message\">{formErrors.caption}</span>\n                  )}\n                </div>\n\n                <div className=\"data-input\">\n                  <div className=\"data-label\">Collaborators: </div>\n                  <input\n                    name=\"collab\"\n                    placeholder=\"Collaborators (Optional)\"\n                    onChange={(e) => this.handleChange(e)}\n                  ></input>\n                </div>\n\n                <div className=\"data-input\">\n                  <div className=\"data-label\">Tags: </div>\n                  <select\n                    className={formErrors.tag.length > 0 ? \"error\" : null}\n                    name=\"tag\"\n                    onChange={(e) => this.handleChange(e)}\n                  >\n                    <option value=\"\">Select...</option>\n                    <option value=\"Art\">Art</option>\n                    <option value=\"Code\">Code</option>\n                    <option value=\"Music\">Music</option>\n                    <option value=\"Film\">Film</option>\n                    <option value=\"Writing\">Writing</option>\n                  </select>\n                  {formErrors.tag.length > 0 && (\n                    <span className=\"error-message\">{formErrors.tag}</span>\n                  )}\n                </div>\n\n                <div className=\"data-input\">\n                  <div className=\"data-label\">URL To Picture: </div>\n                  <input\n                    className={formErrors.url.length > 0 ? \"error\" : null}\n                    name=\"url\"\n                    placeholder=\"URL\"\n                    onChange={(e) => this.handleChange(e)}\n                  ></input>\n                  {formErrors.url.length > 0 && (\n                    <span className=\"error-message\">{formErrors.url}</span>\n                  )}\n                </div>\n              </form>\n            </div>\n          </div>\n\n          <div className=\"modal-footer\">\n            <button\n              type=\"submit\"\n              disabled={this.state.isDisabled}\n              className=\"button post-button\"\n              onClick={this.createPost}\n            >\n              <span>Post</span>\n            </button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nPostForm.propTypes = {\n  onClose: PropTypes.func.isRequired,\n  show: PropTypes.bool.isRequired,\n};\n"]},"metadata":{},"sourceType":"module"}